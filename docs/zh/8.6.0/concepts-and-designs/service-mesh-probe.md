# 服务网格探针

服务网格探针使用了如 Istio 等服务网格实现提供的可扩展机制。

## 什么是服务网格(Service Mesh)?

下面的解释来自 Istio 文档。

> 术语服务网格用来描述组成这些应用程序的微服务网络以及它们之间的交互。随着服务网格的规模和复杂性不断的增长，它将会变得越来越难以理解和管理。它的需求包括服务发现、负载均衡、故障恢复、度量和监控等。服务网格通常还有更复杂的运维需求，比如 A/B 测试、金丝雀发布、速率限制、访问控制和端到端认证。

## 探针从哪里采集数据？

Istio 是一个典型的服务网格设计和实现。其定义了 **控制平面(Control Panel)** 和 **数据平面(Data Panel)**，并被广泛应用。下面是 Istio 的架构：

![Istio 架构](https://istio.io/latest/docs/ops/deployment/architecture/arch.svg)

服务网格探针可以选择从 **数据平面** 采集数据。在 Istio 中，这指的是从 Envoy sidecar(数据平面) 中采集遥测数据。对于每个请求，探针从客户端和服务器端采集两个遥测实体。

## 服务网格如何使后端工作？

你一定发现了，在这类探针中 trace 并不存在，那么为什么 SkyWalking 平台仍然可以工作？

服务网格探针从每个请求中收集遥测数据，因此它们知晓关于源、目标、端点、延迟和状态的信息。有了这些信息，后端将这些调用信息合并来描绘整个拓扑图；通过传入的请求测算每个节点的 metrics。后端通过解析 trace 数据得到的会是相同的 metrics 数据。

因此，简而言之：

**服务网格的 metrics 与 trace 解析器生成的 metrics 是完全相同的。**